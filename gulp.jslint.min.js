/**
 * gulp.jslint.js
 * Copyright (C) 2014 KarimSa Networks.
 **/
"use strict";function doLint(r){return function(e,t){var o,l,n,s,i=function(o){var i;if(e.jslint={},o||!global.JSLINT)i=t(o||"gulp-jslint: failed to load JSLINT.");else if(l=e.contents.toString("utf8"),e.jslint.edition=global.JSLINT.edition,e.jslint.success=global.JSLINT(l,r),e.jslint.errors=global.JSLINT.errors,e.jslint.success){if("default"===r.reporter)r.errorsOnly||console.log("[%s] %s","PASS".green,e.path.replace(path.resolve(__dirname)+"/","").cyan);else try{r.reporter=require(r.reporter),evtStr.pipe(r.reporter)}catch(a){console.log(("error: unknown reporter: "+r.reporter).red)}i=t(null,e)}else{if("default"===r.reporter){for(n="[FAIL] "+e.path.replace(path.resolve(__dirname)+"/",""),s=0;s<global.JSLINT.errors.length;s+=1)global.JSLINT.errors[s]&&(n+="\n       line "+global.JSLINT.errors[s].line+", col "+global.JSLINT.errors[s].character+": "+global.JSLINT.errors[s].reason);console.log("%s",n.red)}else try{r.reporter=require(r.reporter),evtStr.pipe(r.reporter)}catch(u){console.log(("error: unknown reporter: "+r.reporter).red)}process.exit(-1)}return i};return e.isStream()?void(o=t(new Error("gulp-jslint: bad file input."))):(e.isNull()||(global.JSLINT||(global.JSLINT=jslint.load("latest")),o=i(null)),o)}}require("colors");var util=require("util"),fs=require("fs"),path=require("path"),evtStr=require("event-stream"),jslint=require("jslint");module.exports=function(r){return r=r||{},r.reporter=r.reporter||"default",evtStr.map(doLint(r))};