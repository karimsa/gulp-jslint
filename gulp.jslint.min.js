/**
 * gulp.jslint.js
 * Copyright (C) 2014 KarimSa Networks.
 **/
!function(global){"use strict";require("colors");var fs=require("fs"),path=require("path"),evtStr=require("event-stream"),initLint=function(fn){var lintPath=path.resolve(__dirname,"./node_modules/jslint/lib/jslint-latest.js");fs.readFile(lintPath,"utf8",function(err,jslintjs){err?fn(err):(eval(jslintjs+"; global.JSLINT = JSLINT; "),fn(null))})},doLint=function(r){return function(e,t){var l,o,n,i,s=function(l){var s;if(e.jslint={},l||!global.JSLINT)s=t(l||"jslint: failed to load JSLINT.");else if(o=e.contents.toString("utf8"),e.jslint.edition=global.JSLINT.edition,e.jslint.success=global.JSLINT(o,r),e.jslint.errors=global.JSLINT.errors,e.jslint.success){if("default"===r.reporter)console.log("[%s] %s","PASS".green,e.path.replace(path.resolve(__dirname)+"/","").cyan);else try{r.reporter=require(r.reporter),evtStr.pipe(r.reporter)}catch(a){console.log(("error: unknown reporter: "+r.reporter).red)}s=t(null,e)}else{if("default"===r.reporter){for(n="[FAIL] "+e.path.replace(path.resolve(__dirname)+"/",""),i=0;i<global.JSLINT.errors.length;i+=1)global.JSLINT.errors[i]&&(n+="\n       line "+global.JSLINT.errors[i].line+", col "+global.JSLINT.errors[i].character+": "+global.JSLINT.errors[i].reason);console.log("%s",n.red)}else try{r.reporter=require(r.reporter),evtStr.pipe(r.reporter)}catch(u){console.log(("error: unknown reporter: "+r.reporter).red)}process.exit(-1)}return s};return e.isStream()?void(l=t(new Error("jslint: bad file input."))):(e.isNull()||(l=global.JSLINT?s(null):initLint(s)),l)}};module.exports=function(r){return r=r||{},r.reporter=r.reporter||"default",evtStr.map(doLint(r))}}(this);